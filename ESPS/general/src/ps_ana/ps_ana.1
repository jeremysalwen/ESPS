.\" Copyright (c) 1996 Entropic Research Laboratory, Inc.; All rights reserved
.\" @(#)ps_ana.1	1.9 4/3/97 ERL
.ds ]W (c) 1996 Entropic Research Laboratory, Inc.
.TH  PS_ANA 1\-ESPS 4/3/97
.SH NAME

.nf
ps_ana \- pitch-synchronous linear-prediction analysis
.fi
.SH SYNOPSIS
.B
ps_ana
[
.BI\-P " param_file"
] [
.BI\-f " out_f0file"
] [
.BI\-{pr} " range"
] [
.BI\-s " range"
] [
.BI\-o " order"
] [
.BI\-S " frame_step"
] [
.BI\-i " frame_step"
] [
.BI\-c " spec_rep"
] [
.BI\-m " spec_method"
] [
.BI\-w  " window"
] [
.BI\-e " preemphasis"
] [
.BI\-z
] [
.BI\-x " debug_level"
]
.BI in_data
.BI in_pulse
.BI out_file
.SH DESCRIPTION
.PP
\fIPs_ana\fR performs a pitch-synchronous LP (linear prediction)
analysis.  The input file \fIin_data\fR is a speech signal stored in a
FEA_SD file.  The input file \fIin_pulse\fR, typically generated by
the \fIepochs(1-ESPS)\fR program, is a FEA_SD(5-ESPS) file that contains pitch
pulse locations of \fIin_data\fR.
Either
.I in_data
or
.I in_pulse,
but not both, may be "-", for standard input.
.PP
The output file \fIout_file\fR is a
FEA file that contains spectral parameters of the specified type.
Analysis results such as signal RMS, F0, and voicing state can
optionally be stored in the \fIout_f0file\fR indicated by the \fI-f\fR
option.  The pitch-synchronously derived quantities in \fIoutfile\fR
and \fIout_f0file\fR are periodically resampled at 200 Hz, unless the
frame step size is otherwise specified using the \fB-S\fR or \fB-i\fR
option.  In any case the periodic resampling is performed by choosing
the values of the pitch-synchronous parameters from the glottal epoch
closest to the periodic sampling instant, rather than by
interpolation.
.PP
.SH OPTIONS
.PP
The following options are supported:
.TP
.BI \-P " param_file \fR[params]\fP"
uses the parameter file 
.I param_file
rather than the default, which is \fIparams\fP. 
.TP
.BI \-f " out_f0file"
The output file name of a file to store analysis results of signal
RMS, F0 (fundamental frequency), and 
voicing state.  These results are periodically resampled at
the same rate as those in the "out_file".
.TP
.BI \-r " first:last"
.TP
.BI \-r " first:+incr"
Determines the range of points from input file.  In
the first form, a pair of unsigned integers gives the first and last points
of the range.  If \fIfirst\fR is omitted, 1 is used.  If \fIlast\fR is
omitted, the last point in the file is used.  The second form is equivalent
to the first with \fIlast = first + incr\fR.  If the range is omitted, the
entire file is processed.
.TP
.BI \-p " "
Same as the \fB-r\fR option.
.TP
.BI \-s " first:last"
.TP
.BI \-s " first:+incr"
Same function as the \fB-r\fR option, but specifies the range of input data 
in seconds.
.TP
.BI \-o " order \fR[0]\fP"
Order for LP analysis.  The default value 0 means the program will choose
an order equal to \fI2 + (Fs/1000)\fR, where \fIFs\fR is the sampling 
frequency of the input data file \fIin_data\fR.
.TP
.BI \-S " frame_step [0.005 * sampling frequency]"
Specifies frame step in samples.
.TP
.BI \-i " frame_step [0.005]"
Specifies frame step in seconds.
.TP
.BI \-c " spec_rep \fR[RC]\fP"
Spectral analysis type.  Valid value is \fI"RC"\fR for reflection
coefficients, or \fI"AFC"\fR for autoregressive filter coefficients
(or linear prediction coefficients).
.TP
.BI \-m " spec_method \fR[AUTOC]\fP"
Method to compute \fIspec_rep\fR.  Valid value is \fI"AUTOC"\fR
for autocorrelation method, or \fI"COV"\fR for covariance method.
.TP
.BI \-w " window \fR[HANNING]\fP"
Windowing technique used in the spectral analysis method.  Valid value
is \fI"HANNING"\fR, \fI"HAMMING"\fR, \fI"RECT"\fR, or
\fI"COS4"\fR, for Hanning, Hamming, rectangular, and cos4 window, respectively.
.TP
.BI \-p " preemphasis \fR[0.95]\fP"
First-order preemphasis filter constant used before the LPC analysis.
Note that the RMS values returned in the optional \fIout_f0file\fR are
based on the preemphasized signal in the pitch-synchronous analysis
window.
.TP
.BI \-z
This option reverses the signs of output LPC parameters in \fIoutfile\fR.
.TP
.BI \-x " debug_level \fR[0]\fP"
If 
.I debug_level
is positive,
.I ps_ana
prints debugging messages and other information on the standard error
output.  The messages proliferate as the  
.I debug_level
increases.  If \fIdebug_level\fP is 0 (the default), no messages are
printed.  
.SH ESPS PARAMETERS
The following ESPS parameters have the same meanings as the command-line
options.
.TP
.I "start - integer"
.IP
The first point in the input sampled data file that is processed.  A
value of 1 denotes the first sample in the file.  This is only read
if the \fB\-p\fP option is not used.  If it is not in the parameter
file, the default value of 1 is used.  
.TP
.I "nan - integer"
.IP
The total number of data points to process.  If 
.I nan
is 0, the whole file is processed.  
.I Nan
is read only if the \fB\-p\fP option is not used.  (See the 
discussion under \fB\-pfP).
.TP
.I " frame_step - float"
Analysis frame step interval to use when resampling the output
parameters.  Valid values are in the range [1/Fs 0.1].
.TP
.I order - int
.IP
See OPTIONS.
.TP
.I spec_rep - string
.IP
See OPTIONS.
.TP
.I spec_method - string
.IP
See OPTIONS.
.TP
.I window - string
.IP
See OPTIONS.
.TP
.I preemphasis - float
.IP
See OPTIONS.
.TP
.I per_step - float
.IP
Step size in seconds for periodic analysis in unvoiced regions.
.TP
.I per_wsize - float
.IP
Window duration in seconds for periodic analysis in unvoiced regions.
.TP
.I ps_wsize - float
.IP
Window duration in fraction of voiced pitch period.  See also the 
\fIphase\fR parameter.
.TP 
.I stability - float
.IP
Stability factor in -dB.
.TP
.I phase - float
.Phase of pitch-synchronous window center in fraction of voiced pitch period.  
This is a number between 0 and 1.  Value 0 means the location of the
window center will be the same as the epoch pulse location.  A value
of 0.75, (the default) causes the window to be centered in the middle
of the "closed glottis" region, assuming an "open quotient" of 0.5.
.PP
.SH ESPS COMMON
No ESPS common parameter processing is supported.
.PP
.SH ESPS HEADERS
The usual \fIrecord_freq\fR, \fIstart_time\fR header items, and all
supported ESPS parameters are stored as generic header items.
.PP
The bandwidth of \fIin_data\fR, usually one half of its sampling frequency,
is recorded as a generic header item \fIbandwidth\fR of DOUBLE type.
.PP
.SH FUTURE CHANGES
.PP
.SH EXAMPLES
.PP
The manual page for \fIepochs\fR includes an example of glottal epoch
detection such as might be performed before using
\fIps_ana\fR. Assuming one has a file "spch.pe" containing impulses at
the estimated instants of glottal closure, and a speech file called
"spch.sd", the following command will produce the files "spch.f0ps"
and "spch.rc".  The ".f0ps" file has F0 estimates obtained by
inverting the inter-pulse intervals from the ".pe" file and RMS
computed from the epoch-synchronous windows of preemphasized data used
by the LPC analysis.
.PP
ps_ana -f spch.f0ps spch.sd spch.pe spch.rc
.PP
.SH ERRORS AND DIAGNOSTICS
.PP
.SH BUGS
.PP
None known.
.SH REFERENCES
Talkin, D. and Rowley, J., "Pitch-Synchronous analysis and synthesis
for TTS systems," \fIProceedings of the ESCA Workshop on Speech
Synthesis\fP, C. Benoit, Ed., Imprimerie des Ecureuils, Gieres, France,
1990.
.PP
.SH "SEE ALSO"
lp_syn(1-ESPS), formant(1-ESPS), get_f0(1-ESPS), 
.br
epochs(1-ESPS), 
get_resid(1-ESPS), FEA(5-ESPS), 
.br
FEA_SD(5-ESPS)
.PP
.SH AUTHOR
David Talkin, Derek Lin
.PP
