.\" Copyright (c) 1996 Entropic Research Laboratory, Inc.; All rights reserved
.\" @(#)formsy.1	1.3 4/1/97 ERL
.ds ]W (c) 1996 Entropic Research Laboratory, Inc.
.TH  FORMSY 1\-ESPS 4/1/97
.SH NAME

.nf
formsy \-  simple, cascaded, pitch-excited speech formant synthesis
.fi
.SH SYNOPSIS
.B
formsy
[
.BI \-P " param_file"
] [
.BI \-b " bandwidths (n.m)"
] [
.BI \-r " frame_rate_scale"
] [
.BI \-a " formant_scale"
] [
.BI \-v " voice_prob"
] [
.BI \-l " min_bandwidth"
] [
.BI \-n " n_formants"
] [
.BI \-s " synthesis_rate"
] [ 
.BI \-h " n_high_pole_formants"
] [
.BI \-f " f0_scale"
] [
.BI \-g
] [
.BI \-e " excite_file"
] [
.BI \-x " debug_level"
]
.I f0file
.I fbfile
.I outfile
.SH DESCRIPTION
\fIFormsy\fR performs a simple n-formant synthesizer.  The
input file \fIf0file\fR is a FEA file containing 3 fields: \fIF0\fR
for fundamental frequency, \fIprob_voice\fR for probability of voicing, 
and \fIrms\fR for amplitude; the input file \fIfbfile\fR is a FEA file 
that contains 2 fields: \fIfm\fR for formant frequency and \fIfb\fR for 
formant bandwidths.  Typically, these input files are generated by 
\fIget_f0(1-ESPS)\fR and \fIformant(1-ESPS)\fR.  The output file
\fIoutfile\fR is a synthesized speech file of FEA_SD format of SHORT data
type.
.PP
\fIFormsy\fR is designed to help assess the validity of formants and F0
estimates, it is not a serious attempt at quality synthesis and should
be used accordingly.
.PP
If an explicit excitation source, rather than a parametric source such as
\fIf0file\fR, should be used for input, use the \fB-e\fR option to
specify a FEA_SD file of SHORT data type.
.PP
.SH OPTIONS
.PP
The following options are supported:
.TP
.BI \-P " param_file \fR[params]\fP"
uses the parameter file \fIparam_file\fR rather than the default, 
which is \fIparams\fP. 
.TP
.BI \-b " bandwidths (n.m)"
Instead of using the bandwidths from the input \fIfbfile\fR, bandwidths
are synthesized from formant frequencies by the formula: bandwidth = n +
( .m * formant frequency).
.TP
.BI \-r " frame_rate_scale \fR[1.0]\fP"
A scale factor to multiply the frame rates of both the input files
\fIf0file\fR and \fIfbfile\fR.  This can be used to change the
effective speech rate without scaling either pitch or formants.
.TP
.BI \-a " formant_scale \fR[1.0]\fP"
A scale factor to multiply the formant frequencies in \fIfbfile\fR.
This can scale the effective size of the vocal tract up or down.
.TP
.BI \-v " voice_prob"
If this is specified, the probability of voicing in the \fIf0file\fR 
file is ignored and the value
of \fIvoice_prob\fR is used throughout the synthesis instead.  A valid value
lies in the interval [0, 1].
.TP
.BI \-l " min_bandwidth"
If this is specified, bandwidths from the \fIfbfile\fR file are 
constrained to be greater than
this value.  The \fB-b\fR and \fB-l\fR options are mutually exclusive
.TP
.BI \-n " n_formants"
Specifies the first \fIn_formants\fR formants in \fIfbfile\fR to use
for synthesis.  That is, if the file contains m formants (m >= n),
then only the first n formants (and bandwidths) will be used during
synthesis.
.TP
.BI \-s " synthesis_rate \fR[16000]\fP"
Specifies the output sampling rate.  
.TP
.BI \-h " n_high_pole_formants"
Specifies \fIn_high_pole_formants\fR constant "higher-pole" formants
during synthesis.  These are held at constant frequencies consistent
with the average values of the lower, variable formant frequencies
read from the ".fb" file.
.TP
.BI \-f " f0_scale \fR[1.0]\fP"
A scale factor to multiply the fundamental frequency from \fIf0file\fR.
.TP
.BI \-g
If specified, amplitude correction is applied after synthesis.  This
tends to improve the quality in the voiced regions and degrade quality
in unvoiced regions.  This tries to compensate for residual energy in
the formant filters from one frame to the next.
.TP
.BI \-e " excite_file"
The name of a FEA_SD file of SHORT data type to use for excitation.  
If \fB-e\fR is specified,
the \fIf0file\fR must NOT be specified and the \fB-v\fR, \fB-s\fR, \fB-f\fR,
\fB-r\fR, and \fB-g\fR options are not available; the synthesis frequency
will be that of the excitation file.
.TP
.BI \-x " debug_level \fR[0]\fP"
If 
.I debug_level
is positive,
.I formsy
prints debugging messages and other information on the standard error
output.  The messages proliferate as the  
.I debug_level
increases.  If \fIdebug_level\fP is 0 (the default), no messages are
printed.  
.SH ESPS PARAMETERS
The following ESPS parameters have the same meanings as the command
line options supported
.TP
.I bandwidths - string
A value of "0.0" means \fIformsy\fR will use formant bandwidths 
from \fIfbfile\fR.  Otherwise, formant bandwidths are determined as
described above.
.TP
.I frame_rate_scale - float
.TP
.I formant_scale - float
.TP
.I voice_prob - float
A value of -1 means \fIformsy\fR will use \fIprob_voice\fR field
in \fIf0file\fR to make voicing decision.
.TP
.I min_bandwidth - float
.TP
.I n_formants - int
A value of -1 means \fIformsy\fR will use all formants available.
.TP
.I synthesis_rate - float
.TP
.I n_high_pole_formants - int
.TP
.I f0_scale - float
.TP
.I amp_correct - string
.TP
.I excite_file - string
.PP
.SH ESPS COMMON
No ESPS common parameter processing is supported
.PP
.SH ESPS HEADERS
The usual \fIrecord_freq\fR, \fIstart_time\fR header items, and the appropriate
parameters used during processing are stored as generic header items.
.PP
.SH FUTURE CHANGES
.PP
.SH EXAMPLES
.PP
.SH ERRORS AND DIAGNOSTICS
.PP
.SH BUGS
The input file \fIf0file\fR must have fields stored in the following order:
F0, prob_voice, rms.  This is not a problem if \fIf0file\fR is
generated by \fIget_f0(1-ESPS)\fR or \fIformant(1-ESPS)\fR.  Otherwise, use
\fIpsps(1-ESPS)\fR to check the field order and \fImergefea(1-ESPS)\fR to 
rearrange the order.  The bug will be corrected in the future.
.SH REFERENCES
.PP
.SH "SEE ALSO"
.nf
\fIget_f0(1-ESPS)\fR, \fIformant(1-ESPS)\fR, \fIlp_syn(1-ESPS)\fR,
\fIFEA(5-ESPS)\fR.
.fi
.PP
.SH AUTHORS
David Talkin, Derek Lin
.PP





