# This material contains unpublished, proprietary software of 
# Entropic Research Laboratory, Inc. Any reproduction, distribution, 
# or publication of this work must be authorized in writing by Entropic 
# Research Laboratory, Inc., and must bear the notice: 
#
#    "Copyright (c) 1990-1993  Entropic Research Laboratory, Inc. 
#                   All rights reserved"
#
# The copyright notice above does not evidence any actual or intended 
# publication of this source code.     
#
# @(#)spec_subr.te	1.1	6/21/93	ERL
# 
# Written by:  
# Checked by:
# Revised by:
#
# Brief description:  test script for spec_subr
#

# TEST ON SYM_EDGE FILE

echo " "
echo "TESTING spec_subr."
echo "Generating test file."

testsd -Tsine -p800 - | fft -z -o6 - test1.spec

echo "Running spec_subr."

spec_subr -b1000:3000 test1.spec test2.spec

echo "Making Ascii comparison file."

cat > test2.asc << aArDvArK1
File: test2.spec

---Universal Part of Header---
File type: FEA (Feature File)
Number of data records: 13
Data is  tagged.
refer file: <stdin>
comment text:
 spec_subr -b1000:3000 test1.spec test2.spec 
Source files: test1.spec
There is no reference header.

Record 1: tag: 1, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-3.063019e+02
1.125000e+03	-3.056142e+02
1.250000e+03	-3.032916e+02
1.375000e+03	-2.979587e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.979587e+02
1.750000e+03	-3.032916e+02
1.875000e+03	-3.056142e+02
2.000000e+03	-3.063019e+02
2.125000e+03	-3.056142e+02
2.250000e+03	-3.032916e+02
2.375000e+03	-2.979587e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.979587e+02
2.750000e+03	-3.032916e+02
2.875000e+03	-3.056142e+02
3.000000e+03	-3.063019e+02

Record 2: tag: 65, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-3.063019e+02
1.125000e+03	-3.056142e+02
1.250000e+03	-2.767514e+02
1.375000e+03	-2.979587e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.979587e+02
1.750000e+03	-2.767514e+02
1.875000e+03	-3.056142e+02
2.000000e+03	-3.063019e+02
2.125000e+03	-3.056142e+02
2.250000e+03	-2.767514e+02
2.375000e+03	-2.979587e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.979587e+02
2.750000e+03	-2.767514e+02
2.875000e+03	-3.056142e+02
3.000000e+03	-3.063019e+02

Record 3: tag: 129, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.737307e+02
1.125000e+03	-2.725071e+02
1.250000e+03	-2.824741e+02
1.375000e+03	-2.746658e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.746658e+02
1.750000e+03	-2.824741e+02
1.875000e+03	-2.725071e+02
2.000000e+03	-2.737307e+02
2.125000e+03	-2.725071e+02
2.250000e+03	-2.824741e+02
2.375000e+03	-2.746658e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.746658e+02
2.750000e+03	-2.824741e+02
2.875000e+03	-2.725071e+02
3.000000e+03	-2.737307e+02

Record 4: tag: 193, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.773553e+02
1.125000e+03	-2.798073e+02
1.250000e+03	-2.708803e+02
1.375000e+03	-2.713043e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.713043e+02
1.750000e+03	-2.708803e+02
1.875000e+03	-2.798073e+02
2.000000e+03	-2.773553e+02
2.125000e+03	-2.798073e+02
2.250000e+03	-2.708803e+02
2.375000e+03	-2.713043e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.713043e+02
2.750000e+03	-2.708803e+02
2.875000e+03	-2.798073e+02
3.000000e+03	-2.773553e+02

Record 5: tag: 257, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.708816e+02
1.125000e+03	-2.701705e+02
1.250000e+03	-2.767514e+02
1.375000e+03	-2.698308e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.698308e+02
1.750000e+03	-2.767514e+02
1.875000e+03	-2.701705e+02
2.000000e+03	-2.708816e+02
2.125000e+03	-2.701705e+02
2.250000e+03	-2.767514e+02
2.375000e+03	-2.698308e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.698308e+02
2.750000e+03	-2.767514e+02
2.875000e+03	-2.701705e+02
3.000000e+03	-2.708816e+02

Record 6: tag: 321, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.767563e+02
1.125000e+03	-2.761513e+02
1.250000e+03	-2.671710e+02
1.375000e+03	-2.689190e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.689190e+02
1.750000e+03	-2.671710e+02
1.875000e+03	-2.761513e+02
2.000000e+03	-2.767563e+02
2.125000e+03	-2.761513e+02
2.250000e+03	-2.671710e+02
2.375000e+03	-2.689190e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.689190e+02
2.750000e+03	-2.671710e+02
2.875000e+03	-2.761513e+02
3.000000e+03	-2.767563e+02

Record 7: tag: 385, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.674089e+02
1.125000e+03	-2.639774e+02
1.250000e+03	-2.743450e+02
1.375000e+03	-2.713477e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.713477e+02
1.750000e+03	-2.743450e+02
1.875000e+03	-2.639774e+02
2.000000e+03	-2.674089e+02
2.125000e+03	-2.639774e+02
2.250000e+03	-2.743450e+02
2.375000e+03	-2.713477e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.713477e+02
2.750000e+03	-2.743450e+02
2.875000e+03	-2.639774e+02
3.000000e+03	-2.674089e+02

Record 8: tag: 449, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.676086e+02
1.125000e+03	-2.686197e+02
1.250000e+03	-2.671710e+02
1.375000e+03	-2.758529e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.758529e+02
1.750000e+03	-2.671710e+02
1.875000e+03	-2.686197e+02
2.000000e+03	-2.676086e+02
2.125000e+03	-2.686197e+02
2.250000e+03	-2.671710e+02
2.375000e+03	-2.758529e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.758529e+02
2.750000e+03	-2.671710e+02
2.875000e+03	-2.686197e+02
3.000000e+03	-2.676086e+02

Record 9: tag: 513, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.674089e+02
1.125000e+03	-2.654207e+02
1.250000e+03	-2.669901e+02
1.375000e+03	-2.675548e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.675548e+02
1.750000e+03	-2.669901e+02
1.875000e+03	-2.654207e+02
2.000000e+03	-2.674089e+02
2.125000e+03	-2.654207e+02
2.250000e+03	-2.669901e+02
2.375000e+03	-2.675548e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.675548e+02
2.750000e+03	-2.669901e+02
2.875000e+03	-2.654207e+02
3.000000e+03	-2.674089e+02

Record 10: tag: 577, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.767563e+02
1.125000e+03	-2.652990e+02
1.250000e+03	-2.740351e+02
1.375000e+03	-2.673576e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.673576e+02
1.750000e+03	-2.740351e+02
1.875000e+03	-2.652990e+02
2.000000e+03	-2.767563e+02
2.125000e+03	-2.652990e+02
2.250000e+03	-2.740351e+02
2.375000e+03	-2.673576e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.673576e+02
2.750000e+03	-2.740351e+02
2.875000e+03	-2.652990e+02
3.000000e+03	-2.767563e+02

Record 11: tag: 641, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.676086e+02
1.125000e+03	-2.652990e+02
1.250000e+03	-2.669315e+02
1.375000e+03	-2.673576e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.673576e+02
1.750000e+03	-2.669315e+02
1.875000e+03	-2.652990e+02
2.000000e+03	-2.676086e+02
2.125000e+03	-2.652990e+02
2.250000e+03	-2.669315e+02
2.375000e+03	-2.673576e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.673576e+02
2.750000e+03	-2.669315e+02
2.875000e+03	-2.652990e+02
3.000000e+03	-2.676086e+02

Record 12: tag: 705, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.000000e+03	-2.674089e+02
1.125000e+03	-2.588130e+02
1.250000e+03	-2.743450e+02
1.375000e+03	-2.702249e+02
1.500000e+03	-1.204775e+02
1.625000e+03	-2.702249e+02
1.750000e+03	-2.743450e+02
1.875000e+03	-2.588130e+02
2.000000e+03	-2.674089e+02
2.125000e+03	-2.588130e+02
2.250000e+03	-2.743450e+02
2.375000e+03	-2.702249e+02
2.500000e+03	-1.345043e+02
2.625000e+03	-2.702249e+02
2.750000e+03	-2.743450e+02
2.875000e+03	-2.588130e+02
3.000000e+03	-2.674089e+02

Record 13: tag: 769, tot_power: 125000, frame_len: 32


freq		re_spec_val	im_spec_val
1.000000e+03	-2.661416e+02
1.125000e+03	5.331533e+00
1.250000e+03	-2.647635e+02
1.375000e+03	1.452049e+00
1.500000e+03	-1.234878e+02
1.625000e+03	-1.472136e+00
1.750000e+03	-2.647635e+02
1.875000e+03	-3.774060e+00
2.000000e+03	-2.661416e+02
2.125000e+03	-5.624051e+00
2.250000e+03	-2.647635e+02
2.375000e+03	-7.121449e+00
2.500000e+03	-1.375146e+02
2.625000e+03	-8.329107e+00
2.750000e+03	-2.647635e+02
2.875000e+03	-9.288778e+00
3.000000e+03	-2.661416e+02

aArDvArK1

echo "Comparing outputs.  There should be as most small differences in"
echo "spectral values and none in frequencies"

psps test2.spec \
    | egrep -v \
	'^File header date:|^Produced by:|^Hostname:path:|^Machine type:' \
    | diff test2.asc -


# TEST ON ARB_FIXED FILE

echo "Running spec_subr on output of previous test."

spec_subr -b1500:2500 test2.spec test3.spec

echo "Making Ascii comparison file."

cat > test3.asc << aArDvArK2
File: test3.spec

---Universal Part of Header---
File type: FEA (Feature File)
Number of data records: 13
Data is  tagged.
refer file: <stdin>
comment text:
 spec_subr -b1500:2500 test2.spec test3.spec 
Source files: test2.spec
There is no reference header.

Record 1: tag: 1, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.979587e+02
1.750000e+03	-3.032916e+02
1.875000e+03	-3.056142e+02
2.000000e+03	-3.063019e+02
2.125000e+03	-3.056142e+02
2.250000e+03	-3.032916e+02
2.375000e+03	-2.979587e+02
2.500000e+03	-1.345043e+02

Record 2: tag: 65, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.979587e+02
1.750000e+03	-2.767514e+02
1.875000e+03	-3.056142e+02
2.000000e+03	-3.063019e+02
2.125000e+03	-3.056142e+02
2.250000e+03	-2.767514e+02
2.375000e+03	-2.979587e+02
2.500000e+03	-1.345043e+02

Record 3: tag: 129, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.746658e+02
1.750000e+03	-2.824741e+02
1.875000e+03	-2.725071e+02
2.000000e+03	-2.737307e+02
2.125000e+03	-2.725071e+02
2.250000e+03	-2.824741e+02
2.375000e+03	-2.746658e+02
2.500000e+03	-1.345043e+02

Record 4: tag: 193, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.713043e+02
1.750000e+03	-2.708803e+02
1.875000e+03	-2.798073e+02
2.000000e+03	-2.773553e+02
2.125000e+03	-2.798073e+02
2.250000e+03	-2.708803e+02
2.375000e+03	-2.713043e+02
2.500000e+03	-1.345043e+02

Record 5: tag: 257, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.698308e+02
1.750000e+03	-2.767514e+02
1.875000e+03	-2.701705e+02
2.000000e+03	-2.708816e+02
2.125000e+03	-2.701705e+02
2.250000e+03	-2.767514e+02
2.375000e+03	-2.698308e+02
2.500000e+03	-1.345043e+02

Record 6: tag: 321, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.689190e+02
1.750000e+03	-2.671710e+02
1.875000e+03	-2.761513e+02
2.000000e+03	-2.767563e+02
2.125000e+03	-2.761513e+02
2.250000e+03	-2.671710e+02
2.375000e+03	-2.689190e+02
2.500000e+03	-1.345043e+02

Record 7: tag: 385, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.713477e+02
1.750000e+03	-2.743450e+02
1.875000e+03	-2.639774e+02
2.000000e+03	-2.674089e+02
2.125000e+03	-2.639774e+02
2.250000e+03	-2.743450e+02
2.375000e+03	-2.713477e+02
2.500000e+03	-1.345043e+02

Record 8: tag: 449, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.758529e+02
1.750000e+03	-2.671710e+02
1.875000e+03	-2.686197e+02
2.000000e+03	-2.676086e+02
2.125000e+03	-2.686197e+02
2.250000e+03	-2.671710e+02
2.375000e+03	-2.758529e+02
2.500000e+03	-1.345043e+02

Record 9: tag: 513, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.675548e+02
1.750000e+03	-2.669901e+02
1.875000e+03	-2.654207e+02
2.000000e+03	-2.674089e+02
2.125000e+03	-2.654207e+02
2.250000e+03	-2.669901e+02
2.375000e+03	-2.675548e+02
2.500000e+03	-1.345043e+02

Record 10: tag: 577, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.673576e+02
1.750000e+03	-2.740351e+02
1.875000e+03	-2.652990e+02
2.000000e+03	-2.767563e+02
2.125000e+03	-2.652990e+02
2.250000e+03	-2.740351e+02
2.375000e+03	-2.673576e+02
2.500000e+03	-1.345043e+02

Record 11: tag: 641, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.673576e+02
1.750000e+03	-2.669315e+02
1.875000e+03	-2.652990e+02
2.000000e+03	-2.676086e+02
2.125000e+03	-2.652990e+02
2.250000e+03	-2.669315e+02
2.375000e+03	-2.673576e+02
2.500000e+03	-1.345043e+02

Record 12: tag: 705, tot_power: 125000, frame_len: 64


freq		re_spec_val	im_spec_val
1.500000e+03	-1.204775e+02
1.625000e+03	-2.702249e+02
1.750000e+03	-2.743450e+02
1.875000e+03	-2.588130e+02
2.000000e+03	-2.674089e+02
2.125000e+03	-2.588130e+02
2.250000e+03	-2.743450e+02
2.375000e+03	-2.702249e+02
2.500000e+03	-1.345043e+02

Record 13: tag: 769, tot_power: 125000, frame_len: 32


freq		re_spec_val	im_spec_val
1.500000e+03	-1.234878e+02
1.625000e+03	-1.472136e+00
1.750000e+03	-2.647635e+02
1.875000e+03	-3.774060e+00
2.000000e+03	-2.661416e+02
2.125000e+03	-5.624051e+00
2.250000e+03	-2.647635e+02
2.375000e+03	-7.121449e+00
2.500000e+03	-1.375146e+02

aArDvArK2

echo "Comparing outputs.  There should be as most small differences in"
echo "spectral values and none in frequencies"

psps test3.spec \
    | egrep -v \
	'^File header date:|^Produced by:|^Hostname:path:|^Machine type:' \
    | diff test3.asc -

echo "DONE testing spec_subr."
echo " "

# rm test1.spec test2.spec test2.asc test3.spec test3.asc
